
########################################## 
# Add radiation induced side effects
########################################## 
map:radiationInducedSideEffectsQuery a rr:LogicalTable;
    rr:sqlQuery """SELECT 
    GEN_IDNUMBER as id, 
    HN_TOX_WEIGHT as weight,
    HN_TOX_XEROSTOMIA as xerostomia,
    HN_TOX_DYSPH as dysphagia,
    HN_TOX_DYSPH_UMCG as dysphagiaUMCG,
    HN_TOX_MUCOSITIS as oralMucositis,
    HN_TOX_MUCOSA_RTOG as mucosaRTOG,
    HN_TOX_DERMATITIS as dermatitisRadiation,
    HN_TOX_OSTEORADION as osteoRadioNecrosis,
    HN_TOX_SOFTNECR as softTissueNecrosis
        FROM PBDWHackathon2018;""";
    rdfs:label "";
    skos:definition "".

map:radiationInducedSideEffects a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/cancerTreatment/radiotherapy/radiationInducedSideEffects";
        rr:class roo:radiationInducedSideEffects; #new roo class                                                         
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:weightloss; 
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                        
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:xerostomia; 
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                        
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:dysphagia; 
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                        
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:dysphagiaUMCG;  
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                   
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:oralMucositis;    
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                     
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:mucosaRTOG;    
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                     
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:dermatitisRadiation; 
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                        
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:osteoRadioNecrosis;    
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                     
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100423; #consists_of
        rr:objectMap [
            rr:parentTriplesMap map:softTissueNecrosis;   
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                      
        ];
    ].

map:weightloss a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/weightloss/{weight}";
        rr:class ncit:C3445; #weightloss 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100042;  #has_value
        rr:objectMap [
            rr:column "weight"; 
            rr:datatype xsd:float; 
        ];
    ];
    rr:predicateObjectMap [
        rr:predicate roo:P100027;  #has unit
        rr:objectMap [
            rr:parentTriplesMap map:kilogram;
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];                                                       
        ]; 
    ].

map:xerostomia a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/xerostomia/{xerostomia}";
        rr:class ncit:C26917; #xerostomia 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "xerostomia"; 
            rr:datatype xsd:string;
        ];
    ].

map:dysphagia a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/dysphagia/{dysphagia}";
        rr:class ncit:C2980; #dysphagia 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "dysphagia"; 
            rr:datatype xsd:string;
        ];
    ].

map:dysphagiaUMCG a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/dysphagiaUMCG/{dysphagiaUMCG}";                                                                    
        rr:class roo:dysphagiaUMCG; #new roo class 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "dysphagiaUMCG"; 
            rr:datatype xsd:string; 
        ];
    ].

map:oralMucositis a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/oralMucositis/{oralMucositis}";
        rr:class ncit:C26887; #stomatitis 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "oralMucositis"; 
            rr:datatype xsd:string;
        ];
    ].

map:mucosaRTOG a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/mucosaRTOG/{mucosaRTOG}";
        rr:class roo:mucosaRTOG; #new roo class 
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "mucosaRTOG"; 
            rr:datatype xsd:string;
        ];
    ].

map:dermatitisRadiation a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/dermatitisRadiation/{dermatitisRadiation}";
        rr:class ncit:C26887; #dermatitis radiation CTCAE
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "dermatitisRadiation"; 
            rr:datatype xsd:string;
        ];
    ].

map:osteoRadioNecrosis a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/osteoRadioNecrosis/{osteoRadioNecrosis}";
        rr:class ncit:C63707; #osteoRadioNecrosis
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "osteoRadioNecrosis"; 
            rr:datatype xsd:string;
        ];
    ].

map:softTissueNecrosis a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "patient/{id}/radiationInducedSideEffects/softTissueNecrosis/{softTissueNecrosis}";
        rr:class ncit:C53841; #soft tissue necrosis CTCAE
    ];
    rr:predicateObjectMap [
        rr:predicate roo:local_value;
        rr:objectMap [
            rr:column "softTissueNecrosis"; 
            rr:datatype xsd:string;
        ];
    ].

map:kilogram a rr:TriplesMap;
    rr:logicalTable map:radiationInducedSideEffectsQuery;
    rr:subjectMap [
        rr:template "kilogram";
        rr:class uo:0000009; #kilogram
    ].

map:radiotherapy rr:predicateObjectMap [
        rr:predicate roo:P100258; # has_disease_finding
        rr:objectMap [
            rr:parentTriplesMap map:radiationInducedSideEffects;
            rr:joinCondition [
                rr:child "id";
                rr:parent "id";
            ];
        ];
    ].